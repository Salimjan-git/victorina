<!-- templates/quizzes/create_simple.html -->
{% extends "base.html" %}

{% block title %}Эҷоди викторинаи нав{% endblock %}

{% block content %}
<div class="container py-4">
    <h1 class="display-5 fw-bold mb-4">
        <i class="fas fa-plus-circle me-2 text-primary"></i>
        Эҷоди викторинаи нав (версияи сода)
    </h1>
    
    {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}
    
    <form method="post" action="{% url 'quiz_create' %}">
        {% csrf_token %}
        
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label fw-bold">Унвони викторина *</label>
                    <input type="text" name="title" class="form-control" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label fw-bold">Фан</label>
                    <select name="subject" class="form-select">
                        <option value="">Без фан</option>
                        {% for subject in subjects %}
                        <option value="{{ subject.id }}">{{ subject.name }}</option>
                        {% empty %}
                        <option disabled>Ягон фан вуҷуд надорад</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Тавсиф</label>
                    <textarea name="description" class="form-control" rows="3"></textarea>
                </div>
                
                <!-- Hidden fields with default values -->
                <input type="hidden" name="quiz_mode" value="individual">
                <input type="hidden" name="level_type" value="school">
                <input type="hidden" name="start_level" value="1">
                <input type="hidden" name="end_level" value="10">
                <input type="hidden" name="duration" value="30">
                <input type="hidden" name="max_attempts" value="1">
                <input type="hidden" name="pass_percentage" value="60">
                <input type="hidden" name="status" value="draft">
                
                <div class="mb-3">
                    <label class="form-label">Вақти оғоз</label>
                    <input type="datetime-local" name="start_time" class="form-control">
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Вақти анҷом</label>
                    <input type="datetime-local" name="end_time" class="form-control">
                </div>
            </div>
        </div>
        
        <div class="d-flex justify-content-between">
            <a href="{% url 'quiz_list' %}" class="btn btn-secondary">Бекор кардан</a>
            <button type="submit" class="btn btn-primary">Эҷод кардан</button>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set default datetime values
    const now = new Date();
    const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);
    const nextWeek = new Date(tomorrow.getTime() + 7 * 24 * 60 * 60 * 1000);
    
    function formatDateTime(date) {
        return date.toISOString().slice(0, 16);
    }
    
    const startTimeInput = document.querySelector('input[name="start_time"]');
    const endTimeInput = document.querySelector('input[name="end_time"]');
    
    if (startTimeInput) {
        startTimeInput.value = formatDateTime(tomorrow);
    }
    
    if (endTimeInput) {
        endTimeInput.value = formatDateTime(nextWeek);
    }
});
</script>
{% endblock %}